import json
import logging
import os

import aiofiles
from fastapi import FastAPI, UploadFile

from core import const, util, cg_container
from core.method_finder import MethodFinder

import log_config

log_config.init()

# uvicorn main:app --host 0.0.0.0 --port 1992 --reload
app = FastAPI()

logger = logging.getLogger("main")


@app.get("/")
async def root():
    return {"message": "Hello World"}


@app.post("/check_uploaded")
async def check_uploaded(package_name: str, version_code: int):
    apk_name = f"{package_name}-{version_code}"
    apk_file_path = f"{const.apk_dir}/{apk_name}.apk"
    if os.path.exists(apk_file_path):
        util.get_call_graph(apk_name)
        logger.info(f"{apk_name} already exists.")
        return {"message": "File exists"}
    else:
        logger.info(f"{apk_name} not exists.")
        return {"message": "File not exists"}


# curl -X POST http://localhost:1992/check_uploaded?package_name=cf.playhi.freezeyou&version_code=149

@app.post("/uploadfile")
async def create_upload_file(file: UploadFile):
    temp_out_file_path = f"{const.upload_temp_dir}/{file.filename}"
    async with aiofiles.open(temp_out_file_path, 'wb') as out_file:
        while content := await file.read(1024):  # async read chunk
            await out_file.write(content)  # async write chunk
    new_name = util.get_new_name(temp_out_file_path)
    new_file_path = f"{const.apk_dir}/{new_name}.apk"
    os.rename(temp_out_file_path, new_file_path)
    util.get_call_graph(new_name)
    logger.info(f"File {new_name} uploaded.")
    return {"filename": file.filename}


# curl -F 'file=@/Users/jiakun/Projects/CSAServer/apks/org.woheller69.spritpreise-24.apk' http://localhost:8000/uploadfile
# curl -F 'file=@/Users/jiakun/Downloads/apks/wikipedia.apk' http://localhost:1992/uploadfile


@app.post("/get_permission")
async def get_permission(package_name: str, version_code: int):
    apk_name = f"{package_name}-{version_code}"
    permissions, _ = util.parse_manifest(apk_name)
    return {"permissions": permissions}


# curl -X POST http://localhost:1992/get_permission?package_name=org.woheller69.spritpreise&version_code=24
# curl -X POST http://localhost:1992/get_permission?package_name=com.zhiliaoapp.musically&version_code=2022903010

@app.post("/get_acitivities")
async def get_permission(package_name: str, version_code: int):
    apk_name = f"{package_name}-{version_code}"
    _, activities = util.parse_manifest(apk_name)
    logger.info(f"activities for {activities}")
    screenshot_dir = f"results/screenshots/{apk_name}"
    screenshot_files = [file.replace('.png', '') for file in os.listdir(screenshot_dir)]
    logger.info(f"screenshot_files for {screenshot_files}")
    intersection = list(set(activities) & set(screenshot_files))
    # urls = [f"https://raw.githubusercontent.com/limerick1718/CSAServer/master/results/screenshots/{apk_name}/{activity}.png" for activity in intersection]
    return {"activities": intersection}


# curl -X POST http://localhost:1992/get_acitivities?package_name=org.woheller69.spritpreise&version_code=24
# curl -X POST http://localhost:1992/get_acitivities?package_name=org.wikipedia.alpha&version_code=50476
# curl -X POST http://localhost:1992/get_acitivities?package_name=com.amaze.filemanager&version_code=117
# curl -X POST http://localhost:1992/get_acitivities?package_name=com.zhiliaoapp.musically&version_code=2022903010

@app.post("/debloat_activity")
async def debloat_activity(package_name: str, version_code: int, activity_names: str):
    apk_name = f"{package_name}-{version_code}"
    logger.info(f"Debloat activity {activity_names} for {apk_name}")
    activity_names = activity_names.split(",")
    cg = cg_container.get_cg(apk_name)
    mf = MethodFinder(apk_name, cg)
    to_remove_methods, to_remove_permissions = mf.set_to_remove_activity(activity_names)
    logger.debug(f"removed methods: {to_remove_methods}, removed permissions: {to_remove_permissions}")
    return {"to_remove_methods": to_remove_methods, "to_remove_permissions": to_remove_permissions}


# curl -X POST http://localhost:8000/debloat_activity?package_name=cf.playhi.freezeyou&version_code=149&activity_names=cf.playhi.freezeyou.ui.InstallPackagesActivity,cf.playhi.freezeyou.ui.ManualModeActivity
# curl -X POST http://localhost:1992/debloat_activity?package_name=org.woheller69.spritpreise&version_code=24&activity_names=org.woheller69.spritpreise.activities.ManageLocationsActivity,org.woheller69.spritpreise.activities.AboutActivity
# curl -X POST http://localhost:1992/debloat_activity?package_name=com.zhiliaoapp.musically&version_code=2022903010&activity_names=com.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity,com.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity

@app.post("/debloat_permission")
async def debloat_permission(package_name: str, version_code: int, permissions: str):
    apk_name = f"{package_name}-{version_code}"
    logger.info(f"Debloat permission {permissions} for {apk_name}")
    permissions = permissions.split(",")
    cg = cg_container.get_cg(apk_name)
    mf = MethodFinder(apk_name, cg)
    to_remove_methods, to_remove_permissions = mf.set_to_remove_permission(permissions)
    logger.debug(f"removed methods: {to_remove_methods}, removed permissions: {to_remove_permissions}")
    return {"to_remove_methods": to_remove_methods, "to_remove_permissions": to_remove_permissions}


# curl -X POST http://localhost:8000/debloat_permission?package_name=cf.playhi.freezeyou&version_code=149&permissions=android.permission.USE_BIOMETRIC,android.permission.WRITE_EXTERNAL_STORAGE
# curl -X POST http://localhost:8000/debloat_permission?package_name=org.woheller69.spritpreise&version_code=24&permissions=android.permission.ACCESS_FINE_LOCATION,android.permission.ACCESS_COARSE_LOCATION,android.permission.ACCESS_BACKGROUND_LOCATION
# curl -X POST http://localhost:1992/debloat_permission?package_name=com.zhiliaoapp.musically&version_code=2022903010&permissions=android.permission.RECEIVE_BOOT_COMPLETED,com.android.vending.BILLING,android.permission.FOREGROUND_SERVICE


@app.post("/keeponly")
async def keeponly(package_name: str, version_code: int, executed_methods: str):
    apk_name = f"{package_name}-{version_code}"
    cg = cg_container.get_cg(apk_name)
    mf = MethodFinder(apk_name, cg)
    executed_methods = util.extract_methods_from_requests(executed_methods)
    logger.info(f"Keep only for {apk_name} with {executed_methods}")
    to_remove_methods = mf.keep_only(executed_methods)
    return {"to_remove_methods": to_remove_methods}


# curl -X POST http://localhost:1992/keeponly?package_name=org.woheller69.spritpreise&version_code=24&executed_methods=%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20org.woheller69.spritpreise.database.CityToWatch%20convertCityToWatched(org.woheller69.spritpreise.database.City)%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20int%20getNavigationDrawerID()%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onResume()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onDestroy()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20addCityToList(org.woheller69.spritpreise.database.City)%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20int%20getNavigationDrawerID()%3E
# curl -X POST http://localhost:1992/keeponly?package_name=com.zhiliaoapp.musically&version_code=2022903010&executed_methods=%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20X.X6W%20getInflater()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onSaveInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZJ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(com.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20dJ_()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onRestoreInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20finish()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LJII()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20LIZ(android.content.Intent)%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20java.lang.String%20getBtmPageCode()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onCreate(android.os.Bundle)%3E


@app.post("/similar")
async def similar(package_name: str, version_code: int, executed_methods: str):
    apk_name = f"{package_name}-{version_code}"
    cg = cg_container.get_cg(apk_name)
    mf = MethodFinder(apk_name, cg)
    executed_methods = util.extract_methods_from_requests(executed_methods)
    logger.info(f"Generalization for {apk_name} with {executed_methods} using threshold 0.7")
    result_dict = {}
    threshold = 0.7
    similarity_matrix, indices = util.load_similarity_file(apk_name, threshold)
    logger.info(f"Load similarity file for {apk_name} finish")
    if similarity_matrix is None:
        return {"to_remove_methods": "Similarity not ready"}
    to_remove_methods = mf.generalization(executed_methods, similarity_matrix, indices)
    result_dict[threshold] = to_remove_methods
    result = json.dumps(result_dict)
    return {"to_remove_methods": result}


# curl -X POST http://localhost:1994/similar?package_name=org.woheller69.spritpreise&version_code=24&executed_methods=%3C%20int%20com.google.android.material.color.MaterialColors.getColor%28android.content.Context%2Cint%2Cint%29%3E%2C%3C%20androidx.preference.EditTextPreference%24SimpleSummaryProvider%20androidx.preference.EditTextPreference%24SimpleSummaryProvider.getInstance%28%29%3E%2C%3C%20boolean%20androidx.appcompat.widget.VectorEnabledTintResources.shouldBeUsed%28%29%3E%2C%3C%20java.util.Map%20kotlin.collections.MapsKt__MapsKt.toMap%28java.lang.Iterable%29%3E%2C%3C%20com.google.android.material.shape.CornerTreatment%20com.google.android.material.shape.MaterialShapeUtils.createDefaultCornerTreatment%28%29%3E%2C%3C%20void%20androidx.tracing.TraceApi18Impl.beginSection%28java.lang.String%29%3E%2C%3C%20void%20androidx.appcompat.widget.DrawableUtils.fixDrawable%28android.graphics.drawable.Drawable%29%3E%2C%3C%20void%20androidx.lifecycle.ViewTreeViewModelStoreOwner.set%28android.view.View%2Candroidx.lifecycle.ViewModelStoreOwner%29%3E%2C%3C%20boolean%20androidx.core.util.ObjectsCompat.equals%28java.lang.Object%2Cjava.lang.Object%29%3E%2C%3C%20void%20androidx.appcompat.widget.TooltipCompat%24Api26Impl.setTooltipText%28android.view.View%2Cjava.lang.CharSequence%29%3E%2C%3C%20void%20androidx.lifecycle.SavedStateHandleSupport.enableSavedStateHandles%28androidx.savedstate.SavedStateRegistryOwner%29%3E%2C%3C%20android.content.res.ColorStateList%20androidx.core.content.res.ResourcesCompat%24Api23Impl.getColorStateList%28android.content.res.Resources%2Cint%2Candroid.content.res.Resources%24Theme%29%3E%2C%3C%20android.graphics.PorterDuff%24Mode%20com.google.android.material.internal.ViewUtils.parseTintMode%28int%2Candroid.graphics.PorterDuff%24Mode%29%3E%2C%3C%20android.view.PointerIcon%20androidx.core.view.PointerIconCompat%24Api24Impl.getSystemIcon%28android.content.Context%2Cint%29%3E%2C%3C%20void%20androidx.core.widget.TextViewCompat%24Api17Impl.setCompoundDrawablesRelative%28android.widget.TextView%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%29%3E%2C%3C%20androidx.emoji2.text.FontRequestEmojiCompatConfig%20androidx.emoji2.text.DefaultEmojiCompatConfig.create%28android.content.Context%29%3E%2C%3C%20void%20androidx.core.view.MenuItemCompat.setContentDescription%28android.view.MenuItem%2Cjava.lang.CharSequence%29%3E%2C%3C%20void%20androidx.core.widget.EdgeEffectCompat%24Api21Impl.onPull%28android.widget.EdgeEffect%2Cfloat%2Cfloat%29%3E%2C%3C%20androidx.savedstate.SavedStateRegistryController%20androidx.savedstate.SavedStateRegistryController.create%28androidx.savedstate.SavedStateRegistryOwner%29%3E%2C%3C%20java.util.Map%20com.android.volley.toolbox.HttpHeaderParser.getCacheHeaders%28com.android.volley.Cache%24Entry%29%3E%2C%3C%20kotlin.Pair%20kotlin.TuplesKt.to%28java.lang.Object%2Cjava.lang.Object%29%3E%2C%3C%20void%20androidx.core.widget.TextViewCompat.setCompoundDrawablesRelative%28android.widget.TextView%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%2Candroid.graphics.drawable.Drawable%29%3E%2C%3C%20androidx.core.os.LocaleListCompat%20androidx.core.os.ConfigurationCompat.getLocales%28android.content.res.Configuration%29%3E%2C%3C%20boolean%20androidx.core.view.MotionEventCompat.isFromSource%28android.view.MotionEvent%2Cint%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api16Impl.postOnAnimation%28android.view.View%2Cjava.lang.Runnable%29%3E%2C%3C%20void%20androidx.lifecycle.LifecycleDispatcher.init%28android.content.Context%29%3E%2C%3C%20androidx.appcompat.app.AppCompatDelegate%20androidx.appcompat.app.AppCompatDelegate.create%28android.app.Activity%2Candroidx.appcompat.app.AppCompatCallback%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api20Impl.requestApplyInsets%28android.view.View%29%3E%2C%3C%20byte%5B%5D%20android.system.IcmpHeaders.createIcmpEchoHdr%28boolean%2Cint%29%3E%2C%3C%20androidx.emoji2.text.SpannableBuilder%20androidx.emoji2.text.SpannableBuilder.create%28java.lang.Class%2Cjava.lang.CharSequence%29%3E%2C%3C%20void%20androidx.recyclerview.widget.ViewInfoStore%24InfoRecord.drainCache%28%29%3E%2C%3C%20android.graphics.Typeface%20androidx.core.graphics.TypefaceCompat.create%28android.content.Context%2Candroid.graphics.Typeface%2Cint%29%3E%2C%3C%20org.chromium.base.TraceEvent%20org.chromium.base.TraceEvent.I0%28java.lang.String%29%3E%2C%3C%20androidx.startup.AppInitializer%20androidx.startup.AppInitializer.getInstance%28android.content.Context%29%3E%2C%3C%20int%20androidx.core.widget.TextViewCompat.getMaxLines%28android.widget.TextView%29%3E%2C%3C%20java.lang.StringBuilder%20W80.a%28java.lang.String%29%3E%2C%3C%20java.lang.String%20kotlin.text.StringsKt__StringsKt.substringAfterLast%24default%28java.lang.String%2Cchar%2Cjava.lang.String%2Cint%2Cjava.lang.Object%29%3E%2C%3C%20android.graphics.drawable.Drawable%20com.google.android.material.resources.MaterialResources.getDrawable%28android.content.Context%2Candroid.content.res.TypedArray%2Cint%29%3E%2C%3C%20java.lang.Object%20androidx.core.util.Preconditions.checkNotNull%28java.lang.Object%2Cjava.lang.Object%29%3E%2C%3C%20androidx.fragment.app.SpecialEffectsController%24Operation%24State%20androidx.fragment.app.SpecialEffectsController%24Operation%24State.from%28int%29%3E%2C%3C%20void%20androidx.core.os.TraceCompat%24Api18Impl.beginSection%28java.lang.String%29%3E%2C%3C%20void%20androidx.core.view.LayoutInflaterCompat.setFactory2%28android.view.LayoutInflater%2Candroid.view.LayoutInflater%24Factory2%29%3E%2C%3C%20com.google.android.material.animation.MotionSpec%20com.google.android.material.animation.MotionSpec.createFromAttribute%28android.content.Context%2Candroid.content.res.TypedArray%2Cint%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api30Impl.setStateDescription%28android.view.View%2Cjava.lang.CharSequence%29%3E%2C%3C%20com.android.volley.RequestQueue%20com.android.volley.toolbox.Volley.newRequestQueue%28android.content.Context%29%3E%2C%3C%20int%20androidx.core.view.GravityCompat.getAbsoluteGravity%28int%2Cint%29%3E%2C%3C%20void%20androidx.core.content.ContextCompat%24Api16Impl.startActivities%28android.content.Context%2Candroid.content.Intent%5B%5D%2Candroid.os.Bundle%29%3E%2C%3C%20boolean%20org.chromium.base.BuildInfo.a%28%29%3E%2C%3C%20void%20e90.l%28long%2Cjava.lang.String%29%3E%2C%3C%20void%20androidx.appcompat.widget.ViewUtils.makeOptionalFitsSystemWindows%28android.view.View%29%3E%2C%3C%20android.content.SharedPreferences%20androidx.preference.PreferenceManager.getDefaultSharedPreferences%28android.content.Context%29%3E%2C%3C%20android.app.Activity%20com.google.android.material.internal.ContextUtils.getActivity%28android.content.Context%29%3E%2C%3C%20android.graphics.Typeface%20androidx.core.content.res.ResourcesCompat.getFont%28android.content.Context%2Cint%2Candroid.util.TypedValue%2Cint%2Candroidx.core.content.res.ResourcesCompat%24FontCallback%29%3E%2C%3C%20androidx.loader.app.LoaderManagerImpl%24LoaderViewModel%20androidx.loader.app.LoaderManagerImpl%24LoaderViewModel.getInstance%28androidx.lifecycle.ViewModelStore%29%3E%2C%3C%20boolean%20com.google.android.material.resources.MaterialAttributes.resolveBoolean%28android.content.Context%2Cint%2Cboolean%29%3E%2C%3C%20long%20U4.a%28android.content.pm.PackageInfo%29%3E%2C%3C%20void%20R80.a%28int%29%3E%2C%3C%20void%20androidx.appcompat.widget.TooltipCompat.setTooltipText%28android.view.View%2Cjava.lang.CharSequence%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api29Impl.saveAttributeDataForStyleable%28android.view.View%2Candroid.content.Context%2Cint%5B%5D%2Candroid.util.AttributeSet%2Candroid.content.res.TypedArray%2Cint%2Cint%29%3E%2C%3C%20boolean%20Ap.a%28%29%3E%2C%3C%20androidx.core.view.WindowInsetsCompat%20androidx.core.view.WindowInsetsCompat.toWindowInsetsCompat%28android.view.WindowInsets%2Candroid.view.View%29%3E%2C%3C%20com.android.volley.toolbox.DiskBasedCache%24CacheHeader%20com.android.volley.toolbox.DiskBasedCache%24CacheHeader.readHeader%28com.android.volley.toolbox.DiskBasedCache%24CountingInputStream%29%3E%2C%3C%20int%5B%5D%20androidx.core.content.res.GrowingArrayUtils.append%28int%5B%5D%2Cint%2Cint%29%3E%2C%3C%20java.lang.String%20org.woheller69.spritpreise.ui.Help.StringFormatUtils.formatTimeWithoutZone%28android.content.Context%2Clong%29%3E%2C%3C%20void%20androidx.core.app.JobIntentService.enqueueWork%28android.content.Context%2Cjava.lang.Class%2Cint%2Candroid.content.Intent%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.content.res.ResourcesCompat%24Api21Impl.getDrawable%28android.content.res.Resources%2Cint%2Candroid.content.res.Resources%24Theme%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api21Impl.setOnApplyWindowInsetsListener%28android.view.View%2Candroidx.core.view.OnApplyWindowInsetsListener%29%3E%2C%3C%20org.woheller69.spritpreise.database.SQLiteHelper%20org.woheller69.spritpreise.database.SQLiteHelper.getInstance%28android.content.Context%29%3E%2C%3C%20com.google.android.material.animation.MotionTiming%20com.google.android.material.animation.MotionTiming.createFromAnimator%28android.animation.ValueAnimator%29%3E%2C%3C%20android.content.Context%20androidx.appcompat.widget.TintContextWrapper.wrap%28android.content.Context%29%3E%2C%3C%20android.content.res.ColorStateList%20com.google.android.material.ripple.RippleUtils.sanitizeRippleDrawableColor%28android.content.res.ColorStateList%29%3E%2C%3C%20org.woheller69.spritpreise.ui.CityFragment%20org.woheller69.spritpreise.ui.CityFragment.newInstance%28android.os.Bundle%29%3E%2C%3C%20void%20androidx.lifecycle.ReportFragment%24LifecycleCallbacks.registerIn%28android.app.Activity%29%3E%2C%3C%20android.os.Handler%20androidx.emoji2.text.ConcurrencyHelpers%24Handler28Impl.createAsync%28android.os.Looper%29%3E%2C%3C%20void%20androidx.lifecycle.ReportFragment.injectIfNeededIn%28android.app.Activity%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api17Impl.setPaddingRelative%28android.view.View%2Cint%2Cint%2Cint%2Cint%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.graphics.drawable.DrawableCompat.wrap%28android.graphics.drawable.Drawable%29%3E%2C%3C%20void%20androidx.lifecycle.ProcessLifecycleOwner.init%28android.content.Context%29%3E%2C%3C%20androidx.customview.widget.ViewDragHelper%20androidx.customview.widget.ViewDragHelper.create%28android.view.ViewGroup%2Cfloat%2Candroidx.customview.widget.ViewDragHelper%24Callback%29%3E%2C%3C%20int%20androidx.core.view.MarginLayoutParamsCompat.getMarginStart%28android.view.ViewGroup%24MarginLayoutParams%29%3E%2C%3C%20androidx.core.graphics.Insets%20androidx.core.graphics.Insets.of%28int%2Cint%2Cint%2Cint%29%3E%2C%3C%20androidx.preference.ListPreference%24SimpleSummaryProvider%20androidx.preference.ListPreference%24SimpleSummaryProvider.getInstance%28%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.content.ContextCompat%24Api21Impl.getDrawable%28android.content.Context%2Cint%29%3E%2C%3C%20android.content.res.ColorStateList%20com.google.android.material.ripple.RippleUtils.convertToRippleDrawableColor%28android.content.res.ColorStateList%29%3E%2C%3C%20androidx.core.app.TaskStackBuilder%20androidx.core.app.TaskStackBuilder.create%28android.content.Context%29%3E%2C%3C%20void%20androidx.core.view.GravityCompat%24Api17Impl.apply%28int%2Cint%2Cint%2Candroid.graphics.Rect%2Candroid.graphics.Rect%2Cint%29%3E%2C%3C%20int%20androidx.core.view.MarginLayoutParamsCompat%24Api17Impl.getMarginStart%28android.view.ViewGroup%24MarginLayoutParams%29%3E%2C%3C%20androidx.lifecycle.viewmodel.CreationExtras%20androidx.lifecycle.ViewModelProviderGetKt.defaultCreationExtras%28androidx.lifecycle.ViewModelStoreOwner%29%3E%2C%3C%20int%20androidx.core.math.MathUtils.clamp%28int%2Cint%2Cint%29%3E%2C%3C%20void%20androidx.coordinatorlayout.widget.ViewGroupUtils.getDescendantRect%28android.view.ViewGroup%2Candroid.view.View%2Candroid.graphics.Rect%29%3E%2C%3C%20androidx.arch.core.executor.ArchTaskExecutor%20androidx.arch.core.executor.ArchTaskExecutor.getInstance%28%29%3E%2C%3C%20androidx.recyclerview.widget.OrientationHelper%20androidx.recyclerview.widget.OrientationHelper.createOrientationHelper%28androidx.recyclerview.widget.RecyclerView%24LayoutManager%2Cint%29%3E%2C%3C%20java.util.List%20kotlin.collections.ArraysUtilJVM.asList%28java.lang.Object%5B%5D%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.appcompat.content.res.AppCompatResources.getDrawable%28android.content.Context%2Cint%29%3E%2C%3C%20androidx.lifecycle.LifecycleEventObserver%20androidx.lifecycle.Lifecycling.lifecycleEventObserver%28java.lang.Object%29%3E%2C%3C%20androidx.core.view.PointerIconCompat%20androidx.core.view.PointerIconCompat.getSystemIcon%28android.content.Context%2Cint%29%3E%2C%3C%20void%20androidx.core.os.TraceCompat.beginSection%28java.lang.String%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.widget.CheckedTextViewCompat%24Api16Impl.getCheckMarkDrawable%28android.widget.CheckedTextView%29%3E%2C%3C%20void%20androidx.core.graphics.drawable.DrawableCompat%24Api21Impl.setTintList%28android.graphics.drawable.Drawable%2Candroid.content.res.ColorStateList%29%3E%2C%3C%20androidx.appcompat.widget.ResourceManagerInternal%20androidx.appcompat.widget.ResourceManagerInternal.get%28%29%3E%2C%3C%20void%20androidx.core.widget.EdgeEffectCompat.onPull%28android.widget.EdgeEffect%2Cfloat%2Cfloat%29%3E%2C%3C%20void%20org.woheller69.spritpreise.ui.updater.ViewUpdater.addSubscriber%28org.woheller69.spritpreise.ui.updater.IUpdateableCityUI%29%3E%2C%3C%20java.lang.String%20org.woheller69.preferences.Utils.getKey%28java.lang.String%29%3E%2C%3C%20java.lang.String%20MR.a%28java.lang.String%2Cjava.lang.String%2Cjava.lang.String%29%3E%2C%3C%20android.content.Context%20com.google.android.material.theme.overlay.MaterialThemeOverlay.wrap%28android.content.Context%2Candroid.util.AttributeSet%2Cint%2Cint%29%3E%2C%3C%20byte%5B%5D%20com.android.volley.toolbox.NetworkUtility.inputStreamToBytes%28java.io.InputStream%2Cint%2Ccom.android.volley.toolbox.ByteArrayPool%29%3E%2C%3C%20boolean%20org.chromium.base.EarlyTraceEvent.e%28%29%3E%2C%3C%20int%20androidx.core.view.ViewCompat%24Api26Impl.getImportantForAutofill%28android.view.View%29%3E%2C%3C%20androidx.emoji2.text.EmojiCompat%20androidx.emoji2.text.EmojiCompat.init%28androidx.emoji2.text.EmojiCompat%24Config%29%3E%2C%3C%20boolean%20androidx.core.view.ViewParentCompat.onStartNestedScroll%28android.view.ViewParent%2Candroid.view.View%2Candroid.view.View%2Cint%2Cint%29%3E%2C%3C%20java.lang.String%20Cp.d%28%29%3E%2C%3C%20void%20HP.d%28java.lang.String%2Cjava.lang.String%2Cjava.lang.Object%5B%5D%29%3E%2C%3C%20android.content.res.TypedArray%20com.google.android.material.internal.ThemeEnforcement.obtainStyledAttributes%28android.content.Context%2Candroid.util.AttributeSet%2Cint%5B%5D%2Cint%2Cint%2Cint%5B%5D%29%3E%2C%3C%20void%20androidx.activity.ComponentActivity%24Api19Impl.cancelPendingInputEvents%28android.view.View%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.content.ContextCompat.getDrawable%28android.content.Context%2Cint%29%3E%2C%3C%20int%20androidx.core.content.res.TypedArrayUtils.getAttr%28android.content.Context%2Cint%2Cint%29%3E%2C%3C%20android.os.LocaleList%20androidx.core.os.LocaleListCompat%24Api24Impl.createLocaleList%28java.util.Locale%5B%5D%29%3E%2C%3C%20android.text.Editable%24Factory%20androidx.emoji2.viewsintegration.EmojiEditableFactory.getInstance%28%29%3E%2C%3C%20android.content.res.ColorStateList%20androidx.core.content.res.ColorStateListInflaterCompat.createFromXml%28android.content.res.Resources%2Corg.xmlpull.v1.XmlPullParser%2Candroid.content.res.Resources%24Theme%29%3E%2C%3C%20android.os.Handler%20org.chromium.base.ThreadUtils.a%28%29%3E%2C%3C%20android.os.LocaleList%20androidx.core.os.ConfigurationCompat%24Api24Impl.getLocales%28android.content.res.Configuration%29%3E%2C%3C%20int%20androidx.core.widget.TextViewCompat%24Api16Impl.getMaxLines%28android.widget.TextView%29%3E%2C%3C%20androidx.viewpager2.adapter.FragmentViewHolder%20androidx.viewpager2.adapter.FragmentViewHolder.create%28android.view.ViewGroup%29%3E%2C%3C%20float%20androidx.core.view.ViewConfigurationCompat.getScaledHorizontalScrollFactor%28android.view.ViewConfiguration%2Candroid.content.Context%29%3E%2C%3C%20void%20kotlin.jvm.internal.Intrinsics.checkNotNullParameter%28java.lang.Object%2Cjava.lang.String%29%3E%2C%3C%20int%20androidx.recyclerview.widget.ScrollbarHelper.computeScrollRange%28androidx.recyclerview.widget.RecyclerView%24State%2Candroidx.recyclerview.widget.OrientationHelper%2Candroid.view.View%2Candroid.view.View%2Candroidx.recyclerview.widget.RecyclerView%24LayoutManager%2Cboolean%29%3E%2C%3C%20java.util.Map%20com.android.volley.toolbox.HttpHeaderParser.toHeaderMap%28java.util.List%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat.setOnApplyWindowInsetsListener%28android.view.View%2Candroidx.core.view.OnApplyWindowInsetsListener%29%3E%2C%3C%20com.android.volley.Response%20com.android.volley.Response.success%28java.lang.Object%2Ccom.android.volley.Cache%24Entry%29%3E%2C%3C%20androidx.fragment.app.FragmentController%20androidx.fragment.app.FragmentController.createController%28androidx.fragment.app.FragmentHostCallback%29%3E%2C%3C%20void%20androidx.savedstate.ViewTreeSavedStateRegistryOwner.set%28android.view.View%2Candroidx.savedstate.SavedStateRegistryOwner%29%3E%2C%3C%20java.util.List%20kotlin.collections.CollectionsKt__CollectionsKt.listOf%28java.lang.Object%5B%5D%29%3E%2C%3C%20void%20androidx.lifecycle.ViewTreeLifecycleOwner.set%28android.view.View%2Candroidx.lifecycle.LifecycleOwner%29%3E%2C%3C%20android.graphics.Insets%20androidx.appcompat.widget.DrawableUtils%24Api29Impl.getOpticalInsets%28android.graphics.drawable.Drawable%29%3E%2C%3C%20boolean%20androidx.core.view.ViewParentCompat%24Api21Impl.onStartNestedScroll%28android.view.ViewParent%2Candroid.view.View%2Candroid.view.View%2Cint%29%3E%2C%3C%20int%20androidx.core.graphics.ColorUtils.setAlphaComponent%28int%2Cint%29%3E%2C%3C%20int%20androidx.recyclerview.widget.ScrollbarHelper.computeScrollOffset%28androidx.recyclerview.widget.RecyclerView%24State%2Candroidx.recyclerview.widget.OrientationHelper%2Candroid.view.View%2Candroid.view.View%2Candroidx.recyclerview.widget.RecyclerView%24LayoutManager%2Cboolean%2Cboolean%29%3E%2C%3C%20void%20androidx.core.view.ViewCompat%24Api24Impl.setPointerIcon%28android.view.View%2Candroid.view.PointerIcon%29%3E%2C%3C%20int%20com.google.android.material.animation.AnimationUtils.lerp%28int%2Cint%2Cfloat%29%3E%2C%3C%20androidx.core.os.LocaleListCompat%20androidx.core.os.LocaleListCompat.wrap%28android.os.LocaleList%29%3E%2C%3C%20void%20org.woheller69.spritpreise.ui.util.photonApiCall.make%28android.content.Context%2Cjava.lang.String%2Cjava.lang.String%2Cjava.lang.String%2Ccom.android.volley.Response%24Listener%2Ccom.android.volley.Response%24ErrorListener%29%3E%2C%3C%20kotlin.Lazy%20kotlin.LazyKt__LazyJVMKt.lazy%28kotlin.jvm.functions.Function0%29%3E%2C%3C%20void%20androidx.tracing.Trace.beginSection%28java.lang.String%29%3E%2C%3C%20int%20androidx.core.graphics.drawable.DrawableCompat%24Api23Impl.getLayoutDirection%28android.graphics.drawable.Drawable%29%3E%2C%3C%20android.view.inputmethod.InputConnection%20androidx.appcompat.widget.AppCompatHintHelper.onCreateInputConnection%28android.view.inputmethod.InputConnection%2Candroid.view.inputmethod.EditorInfo%2Candroid.view.View%29%3E%2C%3C%20void%20androidx.appcompat.widget.AppCompatDrawableManager.preload%28%29%3E%2C%3C%20androidx.appcompat.widget.TintTypedArray%20androidx.appcompat.widget.TintTypedArray.obtainStyledAttributes%28android.content.Context%2Candroid.util.AttributeSet%2Cint%5B%5D%29%3E%2C%3C%20float%20androidx.cardview.widget.RoundRectDrawableWithShadow.calculateVerticalPadding%28float%2Cfloat%2Cboolean%29%3E%2C%3C%20float%20androidx.core.view.ViewConfigurationCompat%24Api26Impl.getScaledHorizontalScrollFactor%28android.view.ViewConfiguration%29%3E%2C%3C%20boolean%20androidx.core.view.ViewCompat%24Api15Impl.hasOnClickListeners%28android.view.View%29%3E%2C%3C%20androidx.core.view.WindowInsetsCompat%20androidx.core.view.ViewCompat%24Api23Impl.getRootWindowInsets%28android.view.View%29%3E%2C%3C%20boolean%20androidx.core.util.ObjectsCompat%24Api19Impl.equals%28java.lang.Object%2Cjava.lang.Object%29%3E%2C%3C%20int%20androidx.core.content.ContextCompat%24Api23Impl.getColor%28android.content.Context%2Cint%29%3E%2C%3C%20androidx.loader.app.LoaderManager%20androidx.loader.app.LoaderManager.getInstance%28androidx.lifecycle.LifecycleOwner%29%3E%2C%3C%20com.google.android.material.shape.ShapeAppearancePathProvider%20com.google.android.material.shape.ShapeAppearancePathProvider.getInstance%28%29%3E%2C%3C%20android.os.Handler%20androidx.emoji2.text.ConcurrencyHelpers.mainHandlerAsync%28%29%3E%2C%3C%20android.content.Context%20androidx.appcompat.app.AppCompatDelegateImpl%24Api17Impl.createConfigurationContext%28android.content.Context%2Candroid.content.res.Configuration%29%3E%2C%3C%20java.lang.Class%20kotlin.jvm.JvmClassMappingKt.getJavaClass%28kotlin.reflect.KClass%29%3E%2C%3C%20androidx.fragment.app.FragmentManagerViewModel%20androidx.fragment.app.FragmentManagerViewModel.getInstance%28androidx.lifecycle.ViewModelStore%29%3E%2C%3C%20long%20D4.a%28%29%3E%2C%3C%20void%20androidx.appcompat.widget.ThemeUtils.checkAppCompatTheme%28android.view.View%2Candroid.content.Context%29%3E%2C%3C%20boolean%20androidx.core.view.ViewCompat%24Api19Impl.isLaidOut%28android.view.View%29%3E%2C%3C%20void%20com.google.android.material.appbar.ViewUtilsLollipop.setBoundsViewOutlineProvider%28android.view.View%29%3E%2C%3C%20android.graphics.drawable.Drawable%20androidx.core.widget.CheckedTextViewCompat.getCheckMarkDrawable%28android.widget.CheckedTextView%29%3E%2C%3C%20androidx.fragment.app.SpecialEffectsController%20androidx.fragment.app.SpecialEffectsController.getOrCreateController%28android.view.ViewGroup%2Candroidx.fragment.app.FragmentManager%29%3E%2C%3C%20android.content.Context%20androidx.appcompat.view.ContextThemeWrapper%24Api17Impl.createConfigurationContext%28androidx.appcompat.view.ContextThemeWrapper%2Candroid.content.res.Configuration%29%3E%2C%3C%20java.lang.String%20u4.a%28%29%3E%2C%3C%20androidx.appcompat.view.ActionBarPolicy%20androidx.appcompat.view.ActionBarPolicy.get%28android.content.Context%29%3E%2C%3C%20java.lang.String%20androidx.core.app.NavUtils.getParentActivityName%28android.app.Activity%29%3E%2C%3C%20java.util.List%20kotlin.collections.ArraysKt___ArraysJvmKt.asList%28java.lang.Object%5B%5D%29%3E%2C%3C%20int%20kotlin.collections.CollectionsKt__IterablesKt.collectionSizeOrDefault%28java.lang.Iterable%2Cint%29%3E%2C%3C%20kotlin.reflect.KClass%20kotlin.jvm.internal.Reflection.getOrCreateKotlinClass%28java.lang.Class%29%3E%2C%3C%20void%20jn.i%28java.lang.String%5B%5D%29%3E
# curl -X POST http://localhost:1992/similar?package_name=com.zhiliaoapp.musically&version_code=2022903010&executed_methods=%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20X.X6W%20getInflater()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onSaveInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZJ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(com.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20dJ_()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onRestoreInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20finish()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LJII()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20LIZ(android.content.Intent)%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20java.lang.String%20getBtmPageCode()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onCreate(android.os.Bundle)%3E

@app.post("/more")
async def more(package_name: str, version_code: int, executed_methods: str):
    apk_name = f"{package_name}-{version_code}"
    cg = cg_container.get_cg(apk_name)
    mf = MethodFinder(apk_name, cg)
    executed_methods = util.extract_methods_from_requests(executed_methods)
    logger.info(f"Generalization for {apk_name} with {executed_methods} using threshold 0.9")
    result_dict = {}
    threshold = 0.9
    similarity_matrix, indices = util.load_similarity_file(apk_name, threshold)
    logger.info(f"Load similarity file for {apk_name} finish")
    if similarity_matrix is None:
        return {"to_remove_methods": "Similarity not ready"}
    to_remove_methods = mf.generalization(executed_methods, similarity_matrix, indices)
    result_dict[threshold] = to_remove_methods
    result = json.dumps(result_dict)
    return {"to_remove_methods": result}
# curl -X POST http://localhost:1994/more?package_name=org.woheller69.spritpreise&version_code=24&executed_methods=%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20org.woheller69.spritpreise.database.CityToWatch%20convertCityToWatched(org.woheller69.spritpreise.database.City)%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20int%20getNavigationDrawerID()%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onResume()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20onDestroy()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20addCityToList(org.woheller69.spritpreise.database.City)%3E-%2C-%3Corg.woheller69.spritpreise.activities.AboutActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Corg.woheller69.spritpreise.activities.ManageLocationsActivity%3A%20int%20getNavigationDrawerID()%3E
# curl -X POST http://localhost:1992/more?package_name=com.zhiliaoapp.musically&version_code=2022903010&executed_methods=%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20X.X6W%20getInflater()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onCreate(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onSaveInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(X.GcL)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZJ(X.GcK)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZ(com.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20dJ_()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LIZIZ(boolean)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20onRestoreInstanceState(android.os.Bundle)%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20finish()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20void%20LJII()%3E-%2C-%3Ccom.ss.android.ugc.aweme.shortvideo.ui.VideoRecordNewActivity%3A%20boolean%20LIZ(android.content.Intent)%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20java.lang.String%20getBtmPageCode()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onPause()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStop()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20%3Cinit%3E()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20android.content.Intent%20getIntent()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onDestroy()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onStart()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onResume()%3E-%2C-%3Ccom.ss.android.ugc.aweme.ecommerce.showcase.store.StoreActivity%3A%20void%20onCreate(android.os.Bundle)%3E
